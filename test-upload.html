<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>E-Y-E Camera - Upload Test</title>
        <link rel="stylesheet" href="./index.css" />
        <style>
            body {
                margin: 0;
                padding: 20px;
                background: #1a1a1a;
                color: #fff;
                font-family: monospace;
            }

            .test-info {
                position: fixed;
                top: 20px;
                left: 20px;
                background: rgba(0,0,0,0.8);
                padding: 15px;
                border-radius: 8px;
                z-index: 1000;
                max-width: 300px;
            }

            .test-info h3 {
                margin: 0 0 10px 0;
                color: #00ff88;
            }

            .test-info ul {
                margin: 0;
                padding-left: 20px;
                font-size: 12px;
                line-height: 1.4;
            }

            .test-info li {
                margin-bottom: 5px;
            }
        </style>
    </head>
    <body>
        <div class="test-info">
            <h3>Upload Test Instructions:</h3>
            <ul>
                <li>Click "Connect" to initialize</li>
                <li>Look for "Upload Image" button in bottom menu</li>
                <li>Upload an image file (jpg, png, etc.)</li>
                <li>Camera feed should pause</li>
                <li>Image should be processed with color separation</li>
                <li>Adjust sliders to see real-time changes</li>
                <li>Click "Close Uploaded Image" to return to camera</li>
            </ul>
        </div>

        <e-y-e
            contrast="150"
            saturation="200"
            brightness="120"
            hue="45"
            color-1="#000000"
            color-2="#ff6c2f"
            color-3="#235ba8"
            color-4="#ff48b0"
            color-5="#f7ff00"
            width-value="7.5"
            height-value="7.5"
            size-unit="cm"
        ></e-y-e>

        <script type="module" src="./index.js"></script>

        <script>
            // Add some debug logging for upload events
            document.addEventListener('DOMContentLoaded', () => {
                const eyeComponent = document.querySelector('e-y-e');

                eyeComponent.addEventListener('NEW PICTURE', (e) => {
                    console.log('NEW PICTURE event fired');
                });

                eyeComponent.addEventListener('IMAGE DRAWN', (e) => {
                    console.log('IMAGE DRAWN event fired with data:', e.detail);
                });

                // Monitor for upload state changes
                const observer = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        if (mutation.type === 'childList') {
                            const uploadBtn = document.querySelector('.upload-image-button');
                            const closeBtn = document.querySelector('.close-upload-button');

                            if (uploadBtn || closeBtn) {
                                console.log('Upload buttons detected:', {
                                    uploadVisible: uploadBtn && uploadBtn.style.display !== 'none',
                                    closeVisible: closeBtn && closeBtn.style.display !== 'none'
                                });
                            }
                        }
                    });
                });

                observer.observe(document.body, {
                    childList: true,
                    subtree: true
                });
            });
        </script>
    </body>
</html>
